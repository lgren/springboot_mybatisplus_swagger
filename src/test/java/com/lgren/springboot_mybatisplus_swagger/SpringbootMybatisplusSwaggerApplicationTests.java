package com.lgren.springboot_mybatisplus_swagger;

import com.alibaba.fastjson.JSON;
import com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;
import com.github.jsonzou.jmockdata.JMockData;
import com.github.jsonzou.jmockdata.MockConfig;
import com.lgren.springboot_mybatisplus_swagger.entity.Clazz;
import com.lgren.springboot_mybatisplus_swagger.entity.Student;
import com.lgren.springboot_mybatisplus_swagger.entity.Teacher;
import com.lgren.springboot_mybatisplus_swagger.service.IClazzService;
import com.lgren.springboot_mybatisplus_swagger.service.IStudentService;
import com.lgren.springboot_mybatisplus_swagger.service.ITeacherService;
import com.lgren.springboot_mybatisplus_swagger.util.LgrenUtil;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.test.context.junit4.SpringRunner;

import java.util.List;
import java.util.Set;
import java.util.concurrent.*;
import java.util.concurrent.atomic.AtomicInteger;
import java.util.stream.Collectors;

@RunWith(SpringRunner.class)
@SpringBootTest
@EnableCaching
public class SpringbootMybatisplusSwaggerApplicationTests {

	@Test
	public void contextLoads() {
	}
    @Autowired
    private IStudentService studentService;
    @Autowired
    private ITeacherService teacherService;
    @Autowired
    private IClazzService clazzService;

    @Test
    public void addData() {
        stuAdd(100_0000);
        teaAdd(100_0000);
//        claAdd(1000);

//        List<String> clazzListStr
//                = clazzService.list(null).stream().map(o -> o.getId() + "L").collect(Collectors.toList());
//        String str = JSON.toJSONString(clazzListStr);
    }

    List<Long> clazzIdList = JSON.parseArray("[1063029962950373378L,1063029962971344897L,1063029962971344898L,1063029962975539201L,1063029962975539202L,1063029962975539203L,1063029962975539204L,1063029962975539205L,1063029962975539206L,1063029962975539207L,1063029962975539208L,1063029962975539209L,1063029962975539210L,1063029962979733505L,1063029962979733506L,1063029962979733507L,1063029962979733508L,1063029962979733509L,1063029962979733510L,1063029962983927809L,1063029962983927810L,1063029962983927811L,1063029962983927812L,1063029962983927813L,1063029962983927814L,1063029962983927815L,1063029962983927816L,1063029962983927817L,1063029962983927818L,1063029962983927819L,1063029962983927820L,1063029962983927821L,1063029962988122114L,1063029962988122115L,1063029962988122116L,1063029962988122117L,1063029962988122118L,1063029962988122119L,1063029962988122120L,1063029962988122121L,1063029962988122122L,1063029962988122123L,1063029962988122124L,1063029962988122125L,1063029962988122126L,1063029962992316417L,1063029962992316418L,1063029962992316419L,1063029962992316420L,1063029962992316421L,1063029962992316422L,1063029962992316423L,1063029962992316424L,1063029962992316425L,1063029962992316426L,1063029962992316427L,1063029962992316428L,1063029962992316429L,1063029962992316430L,1063029962996510722L,1063029962996510723L,1063029962996510724L,1063029962996510725L,1063029962996510726L,1063029962996510727L,1063029962996510728L,1063029962996510729L,1063029962996510730L,1063029962996510731L,1063029962996510732L,1063029962996510733L,1063029962996510734L,1063029962996510735L,1063029962996510736L,1063029963000705026L,1063029963000705027L,1063029963000705028L,1063029963000705029L,1063029963000705030L,1063029963000705031L,1063029963000705032L,1063029963000705033L,1063029963000705034L,1063029963000705035L,1063029963000705036L,1063029963000705037L,1063029963000705038L,1063029963000705039L,1063029963000705040L,1063029963000705041L,1063029963000705042L,1063029963000705043L,1063029963000705044L,1063029963000705045L,1063029963000705046L,1063029963000705047L,1063029963000705048L,1063029963000705049L,1063029963000705050L,1063029963000705051L,1063029963000705052L,1063029963000705053L,1063029963000705054L,1063029963000705055L,1063029963000705056L,1063029963000705057L,1063029963000705058L,1063029963000705059L,1063029963009093634L,1063029963009093635L,1063029963009093636L,1063029963009093637L,1063029963009093638L,1063029963009093639L,1063029963009093640L,1063029963009093641L,1063029963009093642L,1063029963009093643L,1063029963009093644L,1063029963009093645L,1063029963009093646L,1063029963009093647L,1063029963009093648L,1063029963009093649L,1063029963009093650L,1063029963009093651L,1063029963009093652L,1063029963009093653L,1063029963009093654L,1063029963009093655L,1063029963009093656L,1063029963009093657L,1063029963009093658L,1063029963009093659L,1063029963009093660L,1063029963009093661L,1063029963009093662L,1063029963009093663L,1063029963017482241L,1063029963017482242L,1063029963017482243L,1063029963017482244L,1063029963017482245L,1063029963017482246L,1063029963021676545L,1063029963021676546L,1063029963021676547L,1063029963021676548L,1063029963021676549L,1063029963021676550L,1063029963021676551L,1063029963021676552L,1063029963021676553L,1063029963021676554L,1063029963021676555L,1063029963021676556L,1063029963021676557L,1063029963021676558L,1063029963021676559L,1063029963021676560L,1063029963021676561L,1063029963021676562L,1063029963021676563L,1063029963021676564L,1063029963021676565L,1063029963021676566L,1063029963021676567L,1063029963021676568L,1063029963021676569L,1063029963021676570L,1063029963025870849L,1063029963025870850L,1063029963025870851L,1063029963025870852L,1063029963025870853L,1063029963025870854L,1063029963025870855L,1063029963025870856L,1063029963025870857L,1063029963025870858L,1063029963030065153L,1063029963030065154L,1063029963030065155L,1063029963030065156L,1063029963030065157L,1063029963030065158L,1063029963030065159L,1063029963030065160L,1063029963030065161L,1063029963030065162L,1063029963030065163L,1063029963030065164L,1063029963030065165L,1063029963030065166L,1063029963030065167L,1063029963030065168L,1063029963030065169L,1063029963030065170L,1063029963030065171L,1063029963030065172L,1063029963030065173L,1063029963030065174L,1063029963030065175L,1063029963030065176L,1063029963030065177L,1063029963030065178L,1063029963042648066L,1063029963042648067L,1063029963042648068L,1063029963042648069L,1063029963042648070L,1063029963042648071L,1063029963042648072L,1063029963042648073L,1063029963042648074L,1063029963042648075L,1063029963042648076L,1063029963042648077L,1063029963042648078L,1063029963042648079L,1063029963042648080L,1063029963042648081L,1063029963042648082L,1063029963042648083L,1063029963042648084L,1063029963042648085L,1063029963042648086L,1063029963042648087L,1063029963042648088L,1063029963042648089L,1063029963042648090L,1063029963042648091L,1063029963042648092L,1063029963042648093L,1063029963042648094L,1063029963042648095L,1063029963042648096L,1063029963042648097L,1063029963042648098L,1063029963042648099L,1063029963084591106L,1063029963084591107L,1063029963084591108L,1063029963084591109L,1063029963084591110L,1063029963084591111L,1063029963084591112L,1063029963084591113L,1063029963084591114L,1063029963084591115L,1063029963084591116L,1063029963084591117L,1063029963084591118L,1063029963084591119L,1063029963084591120L,1063029963084591121L,1063029963084591122L,1063029963084591123L,1063029963084591124L,1063029963084591125L,1063029963084591126L,1063029963084591127L,1063029963084591128L,1063029963084591129L,1063029963084591130L,1063029963084591131L,1063029963084591132L,1063029963084591133L,1063029963084591134L,1063029963084591135L,1063029963084591136L,1063029963084591137L,1063029963084591138L,1063029963084591139L,1063029963097174017L,1063029963097174018L,1063029963097174019L,1063029963097174020L,1063029963097174021L,1063029963097174022L,1063029963097174023L,1063029963097174024L,1063029963097174025L,1063029963097174026L,1063029963097174027L,1063029963097174028L,1063029963097174029L,1063029963097174030L,1063029963097174031L,1063029963097174032L,1063029963097174033L,1063029963097174034L,1063029963097174035L,1063029963097174036L,1063029963097174037L,1063029963097174038L,1063029963097174039L,1063029963097174040L,1063029963097174041L,1063029963097174042L,1063029963101368322L,1063029963101368323L,1063029963105562626L,1063029963105562627L,1063029963105562628L,1063029963105562629L,1063029963105562630L,1063029963105562631L,1063029963105562632L,1063029963105562633L,1063029963105562634L,1063029963105562635L,1063029963105562636L,1063029963105562637L,1063029963105562638L,1063029963105562639L,1063029963105562640L,1063029963105562641L,1063029963105562642L,1063029963105562643L,1063029963105562644L,1063029963105562645L,1063029963109756930L,1063029963109756931L,1063029963109756932L,1063029963109756933L,1063029963109756934L,1063029963109756935L,1063029963109756936L,1063029963109756937L,1063029963109756938L,1063029963109756939L,1063029963109756940L,1063029963109756941L,1063029963109756942L,1063029963109756943L,1063029963109756944L,1063029963109756945L,1063029963109756946L,1063029963109756947L,1063029963109756948L,1063029963109756949L,1063029963109756950L,1063029963109756951L,1063029963109756952L,1063029963109756953L,1063029963109756954L,1063029963109756955L,1063029963109756956L,1063029963109756957L,1063029963109756958L,1063029963109756959L,1063029963109756960L,1063029963109756961L,1063029963109756962L,1063029963109756963L,1063029963109756964L,1063029963118145537L,1063029963118145538L,1063029963118145539L,1063029963118145540L,1063029963118145541L,1063029963118145542L,1063029963118145543L,1063029963118145544L,1063029963118145545L,1063029963118145546L,1063029963118145547L,1063029963118145548L,1063029963118145549L,1063029963118145550L,1063029963118145551L,1063029963118145552L,1063029963118145553L,1063029963118145554L,1063029963118145555L,1063029963118145556L,1063029963118145557L,1063029963118145558L,1063029963118145559L,1063029963118145560L,1063029963118145561L,1063029963118145562L,1063029963118145563L,1063029963118145564L,1063029963118145565L,1063029963118145566L,1063029963118145567L,1063029963118145568L,1063029963118145569L,1063029963118145570L,1063029963126534145L,1063029963126534146L,1063029963126534147L,1063029963126534148L,1063029963126534149L,1063029963126534150L,1063029963126534151L,1063029963126534152L,1063029963126534153L,1063029963126534154L,1063029963126534155L,1063029963126534156L,1063029963126534157L,1063029963126534158L,1063029963126534159L,1063029963126534160L,1063029963126534161L,1063029963126534162L,1063029963126534163L,1063029963126534164L,1063029963126534165L,1063029963126534166L,1063029963126534167L,1063029963126534168L,1063029963126534169L,1063029963126534170L,1063029963126534171L,1063029963126534172L,1063029963126534173L,1063029963126534174L,1063029963126534175L,1063029963126534176L,1063029963126534177L,1063029963126534178L,1063029963134922753L,1063029963139117057L,1063029963139117058L,1063029963139117059L,1063029963139117060L,1063029963139117061L,1063029963139117062L,1063029963139117063L,1063029963139117064L,1063029963139117065L,1063029963139117066L,1063029963139117067L,1063029963139117068L,1063029963139117069L,1063029963139117070L,1063029963139117071L,1063029963139117072L,1063029963139117073L,1063029963139117074L,1063029963139117075L,1063029963139117076L,1063029963139117077L,1063029963139117078L,1063029963139117079L,1063029963139117080L,1063029963139117081L,1063029963139117082L,1063029963143311362L,1063029963143311363L,1063029963143311364L,1063029963143311365L,1063029963143311366L,1063029963143311367L,1063029963143311368L,1063029963143311369L,1063029963143311370L,1063029963143311371L,1063029963147505665L,1063029963147505666L,1063029963147505667L,1063029963147505668L,1063029963147505669L,1063029963147505670L,1063029963147505671L,1063029963147505672L,1063029963147505673L,1063029963147505674L,1063029963147505675L,1063029963147505676L,1063029963147505677L,1063029963147505678L,1063029963147505679L,1063029963147505680L,1063029963147505681L,1063029963147505682L,1063029963147505683L,1063029963147505684L,1063029963147505685L,1063029963147505686L,1063029963147505687L,1063029963147505688L,1063029963147505689L,1063029963147505690L,1063029963147505691L,1063029963147505692L,1063029963147505693L,1063029963147505694L,1063029963147505695L,1063029963147505696L,1063029963147505697L,1063029963147505698L,1063029963147505699L,1063029963151699969L,1063029963151699970L,1063029963151699971L,1063029963151699972L,1063029963151699973L,1063029963151699974L,1063029963151699975L,1063029963151699976L,1063029963151699977L,1063029963151699978L,1063029963151699979L,1063029963151699980L,1063029963151699981L,1063029963151699982L,1063029963151699983L,1063029963151699984L,1063029963151699985L,1063029963151699986L,1063029963151699987L,1063029963151699988L,1063029963151699989L,1063029963151699990L,1063029963151699991L,1063029963151699992L,1063029963151699993L,1063029963151699994L,1063029963151699995L,1063029963151699996L,1063029963151699997L,1063029963151699998L,1063029963151699999L,1063029963151700000L,1063029963151700001L,1063029963151700002L,1063029963160088577L,1063029963160088578L,1063029963160088579L,1063029963160088580L,1063029963160088581L,1063029963160088582L,1063029963160088583L,1063029963160088584L,1063029963160088585L,1063029963160088586L,1063029963160088587L,1063029963160088588L,1063029963160088589L,1063029963160088590L,1063029963160088591L,1063029963160088592L,1063029963160088593L,1063029963160088594L,1063029963160088595L,1063029963160088596L,1063029963160088597L,1063029963160088598L,1063029963160088599L,1063029963160088600L,1063029963160088601L,1063029963160088602L,1063029963160088603L,1063029963160088604L,1063029963160088605L,1063029963160088606L,1063029963160088607L,1063029963160088608L,1063029963160088609L,1063029963160088610L,1063029963168477186L,1063029963168477187L,1063029963168477188L,1063029963168477189L,1063029963168477190L,1063029963168477191L,1063029963168477192L,1063029963168477193L,1063029963168477194L,1063029963168477195L,1063029963168477196L,1063029963168477197L,1063029963168477198L,1063029963168477199L,1063029963168477200L,1063029963168477201L,1063029963168477202L,1063029963168477203L,1063029963168477204L,1063029963168477205L,1063029963168477206L,1063029963168477207L,1063029963168477208L,1063029963168477209L,1063029963168477210L,1063029963168477211L,1063029963168477212L,1063029963168477213L,1063029963168477214L,1063029963168477215L,1063029963168477216L,1063029963168477217L,1063029963176865794L,1063029963176865795L,1063029963176865796L,1063029963176865797L,1063029963176865798L,1063029963176865799L,1063029963176865800L,1063029963176865801L,1063029963176865802L,1063029963176865803L,1063029963176865804L,1063029963176865805L,1063029963176865806L,1063029963176865807L,1063029963176865808L,1063029963176865809L,1063029963176865810L,1063029963176865811L,1063029963176865812L,1063029963176865813L,1063029963176865814L,1063029963176865815L,1063029963176865816L,1063029963176865817L,1063029963176865818L,1063029963176865819L,1063029963176865820L,1063029963176865821L,1063029963176865822L,1063029963176865823L,1063029963176865824L,1063029963176865825L,1063029963176865826L,1063029963176865827L,1063029963176865828L,1063029963176865829L,1063029963176865830L,1063029963176865831L,1063029963176865832L,1063029963185254402L,1063029963185254403L,1063029963185254404L,1063029963185254405L,1063029963185254406L,1063029963185254407L,1063029963185254408L,1063029963185254409L,1063029963185254410L,1063029963185254411L,1063029963185254412L,1063029963185254413L,1063029963185254414L,1063029963185254415L,1063029963185254416L,1063029963185254417L,1063029963185254418L,1063029963185254419L,1063029963185254420L,1063029963185254421L,1063029963185254422L,1063029963185254423L,1063029963185254424L,1063029963185254425L,1063029963185254426L,1063029963185254427L,1063029963185254428L,1063029963185254429L,1063029963185254430L,1063029963185254431L,1063029963185254432L,1063029963185254433L,1063029963185254434L,1063029963185254435L,1063029963193643010L,1063029963193643011L,1063029963193643012L,1063029963193643013L,1063029963193643014L,1063029963193643015L,1063029963193643016L,1063029963197837314L,1063029963202031617L,1063029963202031618L,1063029963202031619L,1063029963202031620L,1063029963202031621L,1063029963202031622L,1063029963202031623L,1063029963202031624L,1063029963202031625L,1063029963202031626L,1063029963202031627L,1063029963202031628L,1063029963206225921L,1063029963206225922L,1063029963206225923L,1063029963206225924L,1063029963206225925L,1063029963206225926L,1063029963206225927L,1063029963206225928L,1063029963206225929L,1063029963206225930L,1063029963206225931L,1063029963206225932L,1063029963206225933L,1063029963206225934L,1063029963206225935L,1063029963206225936L,1063029963206225937L,1063029963206225938L,1063029963206225939L,1063029963206225940L,1063029963206225941L,1063029963206225942L,1063029963206225943L,1063029963206225944L,1063029963206225945L,1063029963206225946L,1063029963206225947L,1063029963206225948L,1063029963206225949L,1063029963206225950L,1063029963206225951L,1063029963206225952L,1063029963206225953L,1063029963218808834L,1063029963218808835L,1063029963218808836L,1063029963218808837L,1063029963218808838L,1063029963218808839L,1063029963218808840L,1063029963218808841L,1063029963231391746L,1063029963231391747L,1063029963231391748L,1063029963231391749L,1063029963231391750L,1063029963231391751L,1063029963231391752L,1063029963231391753L,1063029963231391754L,1063029963231391755L,1063029963231391756L,1063029963231391757L,1063029963231391758L,1063029963231391759L,1063029963231391760L,1063029963231391761L,1063029963231391762L,1063029963231391763L,1063029963231391764L,1063029963231391765L,1063029963231391766L,1063029963231391767L,1063029963231391768L,1063029963231391769L,1063029963231391770L,1063029963231391771L,1063029963231391772L,1063029963231391773L,1063029963235586050L,1063029963235586051L,1063029963235586052L,1063029963235586053L,1063029963235586054L,1063029963252363266L,1063029963252363267L,1063029963252363268L,1063029963252363269L,1063029963252363270L,1063029963252363271L,1063029963252363272L,1063029963252363273L,1063029963252363274L,1063029963252363275L,1063029963252363276L,1063029963252363277L,1063029963256557570L,1063029963256557571L,1063029963256557572L,1063029963256557573L,1063029963256557574L,1063029963256557575L,1063029963256557576L,1063029963256557577L,1063029963256557578L,1063029963256557579L,1063029963256557580L,1063029963256557581L,1063029963256557582L,1063029963256557583L,1063029963256557584L,1063029963256557585L,1063029963256557586L,1063029963256557587L,1063029963256557588L,1063029963256557589L,1063029963256557590L,1063029963256557591L,1063029963260751873L,1063029963260751874L,1063029963260751875L,1063029963260751876L,1063029963260751877L,1063029963260751878L,1063029963260751879L,1063029963260751880L,1063029963260751881L,1063029963260751882L,1063029963260751883L,1063029963260751884L,1063029963260751885L,1063029963260751886L,1063029963260751887L,1063029963260751888L,1063029963260751889L,1063029963260751890L,1063029963260751891L,1063029963260751892L,1063029963260751893L,1063029963260751894L,1063029963260751895L,1063029963260751896L,1063029963260751897L,1063029963260751898L,1063029963260751899L,1063029963260751900L,1063029963260751901L,1063029963260751902L,1063029963260751903L,1063029963260751904L,1063029963260751905L,1063029963260751906L,1063029963260751907L,1063029963260751908L,1063029963260751909L,1063029963260751910L,1063029963260751911L,1063029963260751912L,1063029963260751913L,1063029963260751914L,1063029963260751915L,1063029963269140481L,1063029963269140482L,1063029963269140483L,1063029963269140484L,1063029963269140485L,1063029963269140486L,1063029963269140487L,1063029963269140488L,1063029963269140489L,1063029963269140490L,1063029963269140491L,1063029963269140492L,1063029963269140493L,1063029963269140494L,1063029963269140495L,1063029963269140496L,1063029963269140497L,1063029963269140498L,1063029963269140499L,1063029963269140500L,1063029963269140501L,1063029963269140502L,1063029963269140503L,1063029963269140504L,1063029963269140505L,1063029963269140506L,1063029963269140507L,1063029963269140508L,1063029963269140509L,1063029963269140510L,1063029963269140511L,1063029963269140512L,1063029963269140513L,1063029963269140514L,1063029963269140515L,1063029963269140516L,1063029963269140517L,1063029963269140518L,1063029963269140519L,1063029963269140520L,1063029963269140521L,1063029963269140522L,1063029963269140523L,1063029963269140524L,1063029963269140525L,1063029963269140526L,1063029963269140527L,1063029963269140528L,1063029963269140529L,1063029963269140530L,1063029963269140531L,1063029963269140532L,1063029963269140533L,1063029963269140534L,1063029963269140535L,1063029963269140536L,1063029963269140537L,1063029963269140538L,1063029963269140539L,1063029963269140540L,1063029963269140541L,1063029963269140542L,1063029963269140543L,1063029963269140544L,1063029963269140545L,1063029963269140546L,1063029963269140547L,1063029963269140548L,1063029963269140549L,1063029963269140550L,1063029963269140551L,1063029963269140552L,1063029963269140553L,1063029963269140554L]", Long.class);

    private int stuAdd(Integer num) {
        MockConfig mockConfig = new MockConfig().stringSeed(
                "浅唱","寂灭","无声","邂逅","流年","落寂",
                "墨年","磬音","浅唱","低吟","晨曦","邂逅",
                "叙述","唯爱","晨曦","回忆","错落","迷茫",
                "深音","铭记","迷遇","暖光","蘩藜","尘宵",
                "恬静","默诺","余音","情殇","背殇","落幕",
                "醉生","沉静","寂冷");
        Integer dataNum = num;// 数据总量
        int nThreads = 50;//线程数

        Set<Student> claAddList = ConcurrentHashMap.newKeySet(dataNum);
        ExecutorService pool = Executors.newFixedThreadPool(nThreads);
        AtomicInteger maxLength = new AtomicInteger(0);
        for (int i = 0; i < nThreads; i++) {
            pool.execute(() -> {
                for (int j = 0, size = dataNum/50; j < size; j++) {
                    Student clazz = JMockData.mock(Student.class, mockConfig);
                    clazz.setClazzId(clazzIdList.get(ThreadLocalRandom.current().nextInt(0, 910)));
                    claAddList.add(clazz);
                    int strVar = LgrenUtil.calStrLength(clazz.toString());
                    if (strVar > maxLength.get()) {
                        maxLength.set(strVar);
                    }
                }
            });
        }
        pool.shutdown();
        try {
            pool.awaitTermination(Long.MAX_VALUE, TimeUnit.NANOSECONDS);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        return studentService.insertBatchAutoCalLen(claAddList, maxLength.get());
    }

    private int teaAdd(Integer num) {
        MockConfig mockConfig = new MockConfig().stringSeed(
                "浅唱","寂灭","无声","邂逅","流年","落寂",
                "墨年","磬音","浅唱","低吟","晨曦","邂逅",
                "叙述","唯爱","晨曦","回忆","错落","迷茫",
                "深音","铭记","迷遇","暖光","蘩藜","尘宵",
                "恬静","默诺","余音","情殇","背殇","落幕",
                "醉生","沉静","寂冷");
        Integer dataNum = num;// 数据总量
        int nThreads = 50;//线程数

        Set<Teacher> teaAddList = ConcurrentHashMap.newKeySet(dataNum);
        ExecutorService pool = Executors.newFixedThreadPool(nThreads);

        AtomicInteger maxLength = new AtomicInteger(0);
        for (int i = 0; i < nThreads; i++) {
            pool.execute(() -> {
                for (int j = 0, size = dataNum/50; j < size; j++) {
                    Teacher teazz = JMockData.mock(Teacher.class, mockConfig);
                    teazz.setClazzId(clazzIdList.get(ThreadLocalRandom.current().nextInt(0, 910)));
                    teaAddList.add(teazz);
                    int strVar = LgrenUtil.calStrLength(teazz.toString());
                    if (strVar > maxLength.get()) {
                        maxLength.set(strVar);
                    }
                }
            });
        }
        pool.shutdown();
        try {
            pool.awaitTermination(Long.MAX_VALUE, TimeUnit.NANOSECONDS);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        return teacherService.insertBatchAutoCalLen(teaAddList, maxLength.get());
    }

    private int claAdd(Integer num) {
        MockConfig mockConfig = new MockConfig().stringSeed(
                "浅唱","寂灭","无声","邂逅","流年","落寂",
                "墨年","磬音","浅唱","低吟","晨曦","邂逅",
                "叙述","唯爱","晨曦","回忆","错落","迷茫",
                "深音","铭记","迷遇","暖光","蘩藜","尘宵",
                "恬静","默诺","余音","情殇","背殇","落幕",
                "醉生","沉静","寂冷");
        Integer dataNum = num;// 数据总量
        int nThreads = 50;//线程数

        Set<Clazz> claAddList = ConcurrentHashMap.newKeySet(dataNum);
        ExecutorService pool = Executors.newFixedThreadPool(nThreads);
        AtomicInteger maxLength = new AtomicInteger(0);
        for (int i = 0; i < nThreads; i++) {
            pool.execute(() -> {
                for (int j = 0, size = dataNum/50; j < size; j++) {
                    Clazz clazz = JMockData.mock(Clazz.class, mockConfig);
                    claAddList.add(clazz);
                    int strVar = LgrenUtil.calStrLength(clazz.toString());
                    if (strVar > maxLength.get()) {
                        maxLength.set(strVar);
                    }
                }
            });
        }
        pool.shutdown();
        try {
            pool.awaitTermination(Long.MAX_VALUE, TimeUnit.NANOSECONDS);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        return clazzService.insertBatchAutoCalLen(claAddList, maxLength.get());
    }

    @Test
    public void userTimeTestAll() {
        String useTime1 = userTimeTest();
        String useTime2 = userTimeTestTwo();
        String useTime3 = userTimeTestThree();
        String useTimeOther = userTimeTestOther();
        System.out.println();
    }

    @Test
    public void userTimeTestAllThread() throws ExecutionException, InterruptedException {
        Long start = System.currentTimeMillis();
        int nThreads = 5;//线程数
        ExecutorService pool = Executors.newFixedThreadPool(nThreads);
        Future<String> useTime1 = pool.submit(this::userTimeTest);
        Future<String> useTime2 = pool.submit(this::userTimeTestTwo);
        Future<String> useTime3 = pool.submit(this::userTimeTestThree);
        Future<String> useTime4 = pool.submit(this::userTimeTestFour);
        Future<String> useTimeOther = pool.submit(this::userTimeTestOther);
        System.out.println("useTimeOther->" + useTimeOther.get());
        System.out.println("useTime4->" + useTime4.get());
        System.out.println("useTime1->" + useTime1.get());
        System.out.println("useTime2->" + useTime2.get());
        System.out.println("useTime3->" + useTime3.get());
        System.out.println((System.currentTimeMillis() - start)/1000 + "s");
        System.out.println();

    }

    public String userTimeTest() {
        Long start = System.currentTimeMillis();
        List<Teacher> list = teacherService.testSelect();
        return (System.currentTimeMillis() - start)/1000 + "s num:" + list.size();
    }
    public String userTimeTestTwo() {
        Long start = System.currentTimeMillis();
        List<Teacher> list = teacherService.testSelectTwo();
        return (System.currentTimeMillis() - start)/1000 + "s num:" + list.size();
    }
    public String userTimeTestThree() {
        Long start = System.currentTimeMillis();
        List<Teacher> list = teacherService.testSelectThree();
        return (System.currentTimeMillis() - start)/1000 + "s num:" + list.size();
    }
    public String userTimeTestFour() {
        Long start = System.currentTimeMillis();
        List<Teacher> list = teacherService.testSelectFour();
        return (System.currentTimeMillis() - start)/1000 + "s num:" + list.size();
    }
    public String userTimeTestOther() {
        Long start = System.currentTimeMillis();
        List<Long> listVar = clazzService.list(new QueryWrapper<Clazz>().eq("class_name", "邂逅")).stream()
                .map(Clazz::getId).collect(Collectors.toList());
        List<Teacher> list = teacherService.list(new QueryWrapper<Teacher>().in("clazz_id", listVar));
        return (System.currentTimeMillis() - start)/1000 + "s num:" + list.size();
    }
}
